---
title: "Non-Significant Overlap"
always_allow_html: yes
output:
  html_document:
    toc: yes
    toc_depth: '3'
    df_print: paged
  html_vignette:
    toc: yes
    toc_depth: 3
    vignette: >
      %\VignetteIndexEntry{Non-Significant Overlap}
      %\VignetteEngine{knitr::rmarkdown}
      %\VignetteEncoding{UTF-8}
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

withr::local_envvar(
  R_USER_CACHE_DIR = tempfile(),
  EUNOMIA_DATA_FOLDER = Sys.getenv("EUNOMIA_DATA_FOLDER", unset = tempfile())
)
```

TreatmentPatterns identifies overlap between two events. If there is significant overlap (dictated by `combinationWindow` and `minPostCombinationDuration`) the two records are spliced up to 3 records:

![](./figures/a05_combination_1.png){#id .class width=100%}

However if the overlap is deemed not significant, the event transition is classified as a *switch* of events. The first treatment is then trucated to the index date of the overlapping event (in this case **Event B**). If you're only interrested in the final pathways that TreatmentPatterns generates, this does not influence your resulting pathways (barring some edge cases). However when you'd like to investigate the patient-level records generated by `computePathways()` this might lead to undesired end dates.

![](./figures/a05_combination_2.png){#id .class width=100%}

## Overlap Method
The `overlapMethod` parameter allows you to specify what method to use to deal with this non-significant overlap: `"truncate"` to truncate the first event, as described before:

```{r, eval=FALSE}
outputEnv <- TreatmentPatterns::computePathways(
  cohorts = cohorts,
  cohortTableName = "cohort_table",
  cdm = cdm,
  overlapMethod = "truncate"
)
```

Or `"keep"`, to keep the start and end dates of both records intact:

```{r, eval=FALSE}
outputEnv <- TreatmentPatterns::computePathways(
  cohorts = cohorts,
  cohortTableName = "cohort_table",
  cdm = cdm,
  overlapMethod = "keep"
)
```
