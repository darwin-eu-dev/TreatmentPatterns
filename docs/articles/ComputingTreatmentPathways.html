<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computing Treatment Pathways • TreatmentPatterns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computing Treatment Pathways">
<meta property="og:description" content="TreatmentPatterns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreatmentPatterns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bestPractices.html">Best practices</a>
    </li>
    <li>
      <a href="../articles/ComputingTreatmentPathways.html">Computing Treatment Pathways</a>
    </li>
    <li>
      <a href="../articles/latestChanges.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/PareReport.html">PaRe Report: TreatmentPatterns [2.6.6]</a>
    </li>
    <li>
      <a href="../articles/usingTreatmentPatternsShinyModules.html">Using TreatmentPatterns' Shiny Modules</a>
    </li>
    <li>
      <a href="../articles/DefiningCohorts.html">Defining Cohorts</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/darwin-eu/TreatmentPatterns/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="ComputingTreatmentPathways_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="ComputingTreatmentPathways_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="ComputingTreatmentPathways_files/sequences-0.1/sequences.css" rel="stylesheet">
<script src="ComputingTreatmentPathways_files/sunburst-binding-2.1.8/sunburst.js"></script><script src="ComputingTreatmentPathways_files/d3-4.5.0/d3.min.js"></script><script src="ComputingTreatmentPathways_files/sankey-1/sankey.js"></script><script src="ComputingTreatmentPathways_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computing Treatment Pathways</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/TreatmentPatterns/blob/HEAD/vignettes/articles/ComputingTreatmentPathways.Rmd" class="external-link"><code>vignettes/articles/ComputingTreatmentPathways.Rmd</code></a></small>
      <div class="hidden name"><code>ComputingTreatmentPathways.Rmd</code></div>

    </div>

    
    
<p>In <strong>1. Defining Cohorts</strong> we discussed how to define
and generate cohorts for <code>TreatmentPatterns</code>. In this section
we assume you are able to generate a cohort table using either
<code>CohortGenerator</code> or <code>CDMConnector</code>.</p>
<p>Lets generate our Viral Sinusitis dummy cohorts provided in
<code>TreatmentPatterns</code> using <code>CDMConnector</code>.</p>
<div class="section level2">
<h2 id="generating-cohorts">Generating Cohorts<a class="anchor" aria-label="anchor" href="#generating-cohorts"></a>
</h2>
<p>First we need to read in our cohorts.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSet</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">##   cohort_definition_id cohort_name    cohort       json   cohort_name_snakecase</span></span>
<span><span class="co">##                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>                    1 acetaminophen  <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  acetaminophen        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>                    2 amoxicillin    <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  amoxicillin          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>                    3 aspirin        <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  aspirin              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>                    4 clavulanate    <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  clavulanate          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>                    5 death          <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  death                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>                    6 doxylamine     <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  doxylamine           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>                    7 penicillinv    <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  penicillinv          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span>                    8 viralsinusitis <span style="color: #949494;">&lt;named list&gt;</span> <span style="color: #949494;">&lt;chr&gt;</span>  viralsinusitis</span></span></code></pre>
<p>Then we can open a connection to our database, in this case
Eunomia.</p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'DatabaseConnector'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:CDMConnector':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     dbms, insertTable</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Download completed!</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  drv <span class="op">=</span> <span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span></span>
<span>  con <span class="op">=</span> <span class="va">con</span>,</span>
<span>  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  writeSchema <span class="op">=</span> <span class="st">"main"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cdm</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;"># OMOP CDM reference (duckdb) of Synthea synthetic health database</span> <span style="color: #00BBBB;">──────────</span></span></span></code></pre>
<pre><code><span><span class="co">## • <span style="font-weight: bold;">omop tables:</span> person, observation_period, visit_occurrence, visit_detail,</span></span>
<span><span class="co">## condition_occurrence, drug_exposure, procedure_occurrence, device_exposure,</span></span>
<span><span class="co">## measurement, observation, death, note, note_nlp, specimen, fact_relationship,</span></span>
<span><span class="co">## location, care_site, provider, payer_plan_period, cost, drug_era, dose_era,</span></span>
<span><span class="co">## condition_era, metadata, cdm_source, concept, vocabulary, domain,</span></span>
<span><span class="co">## concept_class, concept_relationship, relationship, concept_synonym,</span></span>
<span><span class="co">## concept_ancestor, source_to_concept_map, drug_strength</span></span></code></pre>
<pre><code><span><span class="co">## • <span style="font-weight: bold;">cohort tables:</span> -</span></span></code></pre>
<pre><code><span><span class="co">## • <span style="font-weight: bold;">achilles tables:</span> -</span></span></code></pre>
<pre><code><span><span class="co">## • <span style="font-weight: bold;">other tables:</span> -</span></span></code></pre>
<p>Finally we can generate our cohort set as a cohort table into the
database</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[263ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[177ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[167ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[158ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[112ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[165ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[161ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[232ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/cohortCount.html" class="external-link">cohortCount</a></span><span class="op">(</span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">##   cohort_definition_id number_records number_subjects</span></span>
<span><span class="co">##                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>                    1           <span style="text-decoration: underline;">2</span>679            <span style="text-decoration: underline;">2</span>679</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>                    2           <span style="text-decoration: underline;">2</span>130            <span style="text-decoration: underline;">2</span>130</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>                    3           <span style="text-decoration: underline;">1</span>927            <span style="text-decoration: underline;">1</span>927</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>                    4           <span style="text-decoration: underline;">2</span>021            <span style="text-decoration: underline;">2</span>021</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>                    5              0               0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>                    6           <span style="text-decoration: underline;">1</span>393            <span style="text-decoration: underline;">1</span>393</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>                    7           <span style="text-decoration: underline;">1</span>732            <span style="text-decoration: underline;">1</span>732</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span>                    8           <span style="text-decoration: underline;">2</span>159            <span style="text-decoration: underline;">2</span>159</span></span></code></pre>
<p>We can see that all our cohorts are generated in the cohort table.
The cohort with <em>cohort_definition_id</em> 5 has a count of 0, this
is the <em>Death</em> cohort. This is not detrimental, as exit cohorts
are optional, but good to know that Death will not show up in our
results.</p>
</div>
<div class="section level2">
<h2 id="computing-pathways">Computing pathways<a class="anchor" aria-label="anchor" href="#computing-pathways"></a>
</h2>
<p>The <code>computePathways</code> function of
<code>TreatmentPatterns</code> allows us to compute treatment pathways
in our cohort table. In order to do this we need to pre-specify some
parameters.</p>
<p>According to the documentation we need a <code>data.frame</code> that
specifies what cohort is of which type.</p>
<blockquote>
<p>Data frame containing the following columns and data types:</p>
<p>cohortId numeric(1) Cohort ID’s of the cohorts to be used in the
cohort table.</p>
<p>cohortName character(1) Cohort names of the cohorts to be used in the
cohort table.</p>
<p>type character(1) [“target”, “event’,”exit”] Cohort type, describing
if the cohort is a target, event, or exit cohort</p>
</blockquote>
<p>We are able to re-use our <code>cohortSet</code> for this. As it
already contains the cohort ID’s and cohort names. We only have to
remove the <code>cohort</code> and <code>json</code> columns, add a
<code>type</code> column, and rename <code>cohort_definition_id</code>
to <code>cohortId</code> and <code>cohort_name</code> to
<code>cohortName</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span>, <span class="op">-</span><span class="st">"cohort_name_snakecase"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>    cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">##   cohortId cohortName     type  </span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>        1 acetaminophen  event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>        2 amoxicillin    event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        3 aspirin        event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>        4 clavulanate    event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>        5 death          exit  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>        6 doxylamine     event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>        7 penicillinv    event </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span>        8 viralsinusitis target</span></span></code></pre>
<p>With our <code>data.frame</code> of cohort types, CDM reference, and
the cohort table name in our database we can compute the treatment
pathways, with all of the other settings as their defaults.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">defaultSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">defaultSettings</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Andromeda object</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Physical location:  C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0\file81f87d1d6804.sqlite</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Tables:</span></span>
<span><span class="co">## $addRowsFRFS_1 (personId, indexYear, eventCohortId, eventStartDate, eventEndDate, type, age, sex, durationEra, sortOrder, gapPrevious, selectedRows, switch, combinationFRFS, combinationLRFS, eventStartDateNext, eventEndDatePrevious, eventEndDateNext, eventCohortIdPrevious)</span></span>
<span><span class="co">## $addRowsFRFS_2 (personId, indexYear, eventCohortId, eventStartDate, age, sex, eventEndDate, durationEra, gapPrevious, sortOrder, selectedRows, switch, combinationFRFS, combinationLRFS, eventStartDateNext, eventEndDatePrevious, eventEndDateNext, eventCohortIdPrevious)</span></span>
<span><span class="co">## $addRowsLRFS_1 (personId, indexYear, eventCohortId, eventStartDate, eventEndDate, type, age, sex, durationEra, sortOrder, gapPrevious, selectedRows, switch, combinationFRFS, combinationLRFS, eventStartDateNext, eventEndDatePrevious, eventEndDateNext, eventCohortIdPrevious, checkDuration)</span></span>
<span><span class="co">## $addRowsLRFS_2 (personId, indexYear, eventCohortId, eventStartDate, age, sex, eventEndDate, durationEra, gapPrevious, sortOrder, selectedRows, switch, combinationFRFS, combinationLRFS, eventStartDateNext, eventEndDatePrevious, eventEndDateNext, eventCohortIdPrevious, checkDuration)</span></span>
<span><span class="co">## $attrition (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $cohortTable (cohortId.x, personId, subject_id_origin, startDate.x, endDate.x, age.x, sex.x, type.x, cohortId.y, startDate.y, endDate.y, age.y, sex.y, type.y, indexYear, indexDate)</span></span>
<span><span class="co">## $cohorts (cohortId, cohortName, type)</span></span>
<span><span class="co">## $currentCohorts (cohortId, personId, subject_id_origin, startDate, endDate, age, sex)</span></span>
<span><span class="co">## $dbplyr_6Epxqj9f86 (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_A6SYQa2Grm (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_Y4ySoaoQh2 (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_Z2M8Xrcunc (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_cSkDQutjYF (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_egRFrGyyPF (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_nGJacsYo9B (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_oLN1X87rlp (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_ol3lkrBoLU (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $dbplyr_sI90271IHm (number_records, number_subject, reason_id, reason, time)</span></span>
<span><span class="co">## $eventCohorts (cohortId, personId, subject_id_origin, startDate, endDate, age, sex, type)</span></span>
<span><span class="co">## $exitCohorts (cohortId, personId, subject_id_origin, startDate, endDate, age, sex, type)</span></span>
<span><span class="co">## $exitHistory (personId, indexYear, eventCohortId, eventStartDate, eventEndDate, age, sex, durationEra)</span></span>
<span><span class="co">## $labels (eventCohortId, eventCohortName)</span></span>
<span><span class="co">## $metadata (cdmSourceName, cdmSourceAbbreviation, cdmReleaseDate, vocabularyVersion, executionStartDate, packageVersion, rVersion, platform, execution_end_date)</span></span>
<span><span class="co">## $sqlite_stat1 (tbl, idx, stat)</span></span>
<span><span class="co">## $sqlite_stat4 (tbl, idx, neq, nlt, ndlt, sample)</span></span>
<span><span class="co">## $targetCohorts (cohortId, personId, subject_id_origin, startDate, endDate, age, sex, type, indexYear, indexDate)</span></span>
<span><span class="co">## $treatmentHistory (eventCohortId, personId, indexYear, eventStartDate, age, sex, eventEndDate, durationEra, sortOrder, eventSeq, eventCohortName)</span></span></code></pre>
<p>The output of <code>computePathways</code> is an <a href="https://ohdsi.github.io/Andromeda/" class="external-link">Andromeda</a> environment,
which allows us to investigate intermediate results and patient-level
data. <strong>This data is not sharable.</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># treatmentHistory table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">defaultSettings</span><span class="op">$</span><span class="va">treatmentHistory</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   SQL [6 x 11]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0\file81f87d1d6804.sqlite]</span></span></span>
<span><span class="co">##   eventCohortId personId indexYear eventStartDate   age sex    eventEndDate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1                  275      <span style="text-decoration: underline;">1</span>982           <span style="text-decoration: underline;">4</span>425     4 MALE           <span style="text-decoration: underline;">4</span>455</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 1                  570      <span style="text-decoration: underline;">1</span>968           -<span style="color: #BB0000;">562</span>     1 MALE           -<span style="color: #BB0000;">532</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 1                  195      <span style="text-decoration: underline;">1</span>984           <span style="text-decoration: underline;">5</span>156     4 FEMALE         <span style="text-decoration: underline;">5</span>216</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 1                  868      <span style="text-decoration: underline;">1</span>964          -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">956</span>     6 MALE          -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">866</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 1                  164      <span style="text-decoration: underline;">1</span>954          -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">677</span>     2 MALE          -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">617</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 1                  132      <span style="text-decoration: underline;">1</span>966          -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">105</span>     6 FEMALE        -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">015</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: durationEra &lt;int&gt;, sortOrder &lt;dbl&gt;, eventSeq &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventCohortName &lt;chr&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># metadata table</span></span>
<span><span class="va">defaultSettings</span><span class="op">$</span><span class="va">metadata</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   table&lt;`metadata`&gt; [1 x 9]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0\file81f87d1d6804.sqlite]</span></span></span>
<span><span class="co">##   cdmSourceName           cdmSourceAbbreviation cdmReleaseDate vocabularyVersion</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Synthea synthetic heal… Synthea               2019-05-25     v5.0 18-JAN-19   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 5 more variables: executionStartDate &lt;chr&gt;, packageVersion &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   rVersion &lt;chr&gt;, platform &lt;chr&gt;, execution_end_date &lt;chr&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First Recieved First Stopped</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">defaultSettings</span><span class="op">$</span><span class="va">addRowsFRFS_1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   SQL [0 x 19]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0\file81f87d1d6804.sqlite]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 19 variables: personId &lt;lgl&gt;, indexYear &lt;dbl&gt;, eventCohortId &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventStartDate &lt;dbl&gt;, eventEndDate &lt;lgl&gt;, type &lt;lgl&gt;, age &lt;dbl&gt;, sex &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   durationEra &lt;lgl&gt;, sortOrder &lt;lgl&gt;, gapPrevious &lt;lgl&gt;, selectedRows &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   switch &lt;lgl&gt;, combinationFRFS &lt;lgl&gt;, combinationLRFS &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventStartDateNext &lt;lgl&gt;, eventEndDatePrevious &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventEndDateNext &lt;lgl&gt;, eventCohortIdPrevious &lt;lgl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Last Recieved Last Stopped</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">defaultSettings</span><span class="op">$</span><span class="va">addRowsLRFS_1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   SQL [6 x 20]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0\file81f87d1d6804.sqlite]</span></span></span>
<span><span class="co">##   personId indexYear eventCohortId eventStartDate eventEndDate type    age sex  </span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>        3     -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">284</span> 2                      <span style="text-decoration: underline;">12</span>854        <span style="text-decoration: underline;">12</span>854 event    46 FEMA…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>        4       690 2                       <span style="text-decoration: underline;">7</span>081         <span style="text-decoration: underline;">7</span>081 event    19 FEMA…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        5     -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">648</span> 2                         27           27 event    12 MALE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>        8     -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">071</span> 2                      <span style="text-decoration: underline;">12</span>044        <span style="text-decoration: underline;">12</span>044 event    40 FEMA…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>        9       803 2                      <span style="text-decoration: underline;">14</span>022        <span style="text-decoration: underline;">14</span>022 event    38 FEMA…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>       10       163 2                      <span style="text-decoration: underline;">10</span>465        <span style="text-decoration: underline;">10</span>465 event    31 MALE </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 12 more variables: durationEra &lt;int&gt;, sortOrder &lt;dbl&gt;, gapPrevious &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   selectedRows &lt;dbl&gt;, switch &lt;dbl&gt;, combinationFRFS &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   combinationLRFS &lt;dbl&gt;, eventStartDateNext &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventEndDatePrevious &lt;int&gt;, eventEndDateNext &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   eventCohortIdPrevious &lt;chr&gt;, checkDuration &lt;dbl&gt;</span></span></span></code></pre>
<p><code>DatabaseConnector</code> is also supported. The following
parameters are required <strong>instead</strong> of
<code>cdm</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>connectionDetails</code>: ConnectionDetails object form <a href="https://ohdsi.github.io/DatabaseConnector/" class="external-link">DatabaseConnector</a>.</li>
<li>
<code>cdmSchema</code>: Schema where the CDM exists.</li>
<li>
<code>resultSchema</code>: Schema to write the cohort table to.</li>
<li>
<code>tempEmulationSchema</code>: Some database platforms like
Oracle and Impala do not truly support temp tables. To emulate temp
tables, provide a schema with write privileges where temp tables can be
created.</li>
</ol>
<p>The following code snippet works with <code>Eunomia</code>, a cohort
table (cohort_table) exists in the database, and a <code>cohorts</code>
data frame has been created.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="va">cohortTableName</span>,</span>
<span>  connectionDetails <span class="op">=</span> <span class="fu">Eunomia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Eunomia/man/getEunomiaConnectionDetails.html" class="external-link">getEunomiaConnectionDetails</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  resultSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pathway-settings">Pathway settings<a class="anchor" aria-label="anchor" href="#pathway-settings"></a>
</h2>
<p>Even though the default settings work well for most use cases, it
might not work for all situations. The settings below allow us to
influence how the events of interest should be processed to form
treatment pathways.</p>
<table class="table">
<colgroup>
<col width="22%">
<col width="27%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>indexDateOffset</td>
<td>0</td>
<td>Offset the index date of the <code>Target</code> cohort.</td>
</tr>
<tr class="even">
<td>minEraDuration</td>
<td>0</td>
<td>Minimum time an event era should last to be included in
analysis</td>
</tr>
<tr class="odd">
<td>eraCollapseSize</td>
<td>30</td>
<td>Window of time between which two eras of the same event cohort are
collapsed into one era</td>
</tr>
<tr class="even">
<td>combinationWindow</td>
<td>30</td>
<td>Window of time two event cohorts need to overlap to be considered a
combination treatment</td>
</tr>
<tr class="odd">
<td>minPostCombinationDuration</td>
<td>30</td>
<td>Minimum time an event era before or after a generated combination
treatment should last to be included in analysis</td>
</tr>
<tr class="even">
<td>filterTreatments</td>
<td>First</td>
<td>Select first occurrence of (‘First’); changes between (‘Changes’);
or all event cohorts (‘All’).</td>
</tr>
<tr class="odd">
<td>maxPathLength</td>
<td>5</td>
<td>Maximum number of steps included in treatment pathway</td>
</tr>
</tbody>
</table>
<p>The following figure shows how each of these parameters affect the
computation of the treatment pathway.</p>
<p><img src="../reference/figures/pathwaysettings.png" alt="pathwaySettings"> You can add these settings to the
<code>computePathways</code> function call. Lets see what happens when
we set our <code>minEraDuration</code> to <strong>60</strong>, but keep
the rest of the settings mentioned as their default values.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minEra60</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  <span class="co"># Pathway settings</span></span>
<span>  indexDateOffset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minEraDuration <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  eraCollapseSize <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  combinationWindow <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  minPostCombinationDuration <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  filterTreatments <span class="op">=</span> <span class="st">"First"</span>,</span>
<span>  maxPathLength <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in validateComputePathways(): The `minPostCombinationDuration` is set</span></span>
<span><span class="co">## lower than the `minEraDuration`, this might result in unexpected behavior</span></span></code></pre>
<pre><code><span><span class="co">## Warning in validateComputePathways(): The `combinationWindow` is set lower than</span></span>
<span><span class="co">## the `minEraDuration`, this might result in unexpected behavior</span></span></code></pre>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing records &lt; minEraDuration (60)</span></span>
<span><span class="co">##  Records: 2523</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 2216</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 336</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<pre><code><span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 336</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 291</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<pre><code><span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 291</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<pre><code><span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 291</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 291</span></span>
<span><span class="co">##  Subjects: 279</span></span></code></pre>
<p>Number of treatments with a minimum duration of greater or equal to 0
days.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">defaultSettings</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 553</span></span></code></pre>
<p>Number of treatments with a minimum duration of greater or equal to
60 days.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minEra60</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 291</span></span></code></pre>
<div class="section level3">
<h3 id="acute-and-therapy-splits">Acute and Therapy splits<a class="anchor" aria-label="anchor" href="#acute-and-therapy-splits"></a>
</h3>
<p>We can also split our defined event cohorts into
<strong>acute</strong> and <strong>therapy</strong> cohorts.</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>splitEventCohorts</td>
<td>Specify event cohort ID’s (i.e. <code>c(1, 2, 3)</code> to split in
acute (&lt; splitTime days) and therapy (&gt;= splitTime days). As an
example treatment <strong>Drug A</strong> could be split into
<strong>Drug A (therapy)</strong> and <strong>Drug A (acute)</strong>.
And we could set our splitTime to <em>30</em>. <strong>Drug A
(acute)</strong> would be the time before day 0-29 and <strong>Drug A
(therapy)</strong> would be the day 30 or later.</td>
</tr>
<tr class="even">
<td>splitTime</td>
<td>Specify number of days at which each of the split event cohorts
should be split in acute and therapy (i.e. <code>c(20, 30, 10)</code>).
The length of <code>splitTime</code> must equal the length of
<code>splitEventCohorts</code>
</td>
</tr>
</tbody>
</table>
<p>Let’s say we want to assume that the first 60 days of our treatment
is acute, and beyond that therapy.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splitAcuteTherapy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  <span class="co"># Split settings</span></span>
<span>  splitEventCohorts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  splitTime <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splitAcuteTherapy</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">eventCohortName</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "acetaminophen (acute)"             "acetaminophen (acute)+amoxicillin"</span></span>
<span><span class="co">## [3] "acetaminophens (therapy)"          "amoxicillin"                      </span></span>
<span><span class="co">## [5] "amoxicillin+clavulanate"           "aspirin"                          </span></span>
<span><span class="co">## [7] "clavulanate"</span></span></code></pre>
<p>We can see that our Acetaminophen cohorts are split into
Acetaminophen <strong>(acute)</strong> and <strong>(therapy)</strong>.
<em>Acute</em> labels all the Acetaminophen cohorts lasting less than
our defined <code>splitTime</code>, in this case 60 days.
<em>Therapy</em> labels all the Acetaminophen cohorts lasting 60 days or
more.</p>
</div>
<div class="section level3">
<h3 id="include-treatments-in-a-time-frame">Include treatments in a time frame<a class="anchor" aria-label="anchor" href="#include-treatments-in-a-time-frame"></a>
</h3>
<p>We can dictate in what time frame we want to look. We can look from
the start date of our target cohort and on wards, or we can look before
the end date of our target cohort. By default
<code>TreatmentPatterns</code> looks from the start date and
onwards.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">includeEndDate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  <span class="co"># Split settings</span></span>
<span>  includeTreatments <span class="op">=</span> <span class="st">"endDate"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span></span>
<span>  <span class="va">includeEndDate</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">personId</span><span class="op">)</span>,</span>
<span>  <span class="va">defaultSettings</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">personId</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>In our example case for Viral Sinusitis it appears to not matter, as
the personID’s are identical.</p>
</div>
</div>
<div class="section level2">
<h2 id="exporting-result-objects">Exporting result objects<a class="anchor" aria-label="anchor" href="#exporting-result-objects"></a>
</h2>
<p>The <code>export</code> function allows us to export the generated
result objects from <code>computePathways</code>. There are several
arguments that we can change to alter the behavior, depending on what we
are allowed to share.</p>
<div class="section level3">
<h3 id="mincellcount-and-censortype">minCellCount and censorType<a class="anchor" aria-label="anchor" href="#mincellcount-and-censortype"></a>
</h3>
<p>Let’s say we are only able to share results of groups of subjects
that have at least 5 subjects in them.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tempDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">defaultSettings</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 1219 pathways with a frequency &lt;5 to 5.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/default/countsSex.csv</span></span></code></pre>
<p>We can also choose between different methods how to handle pathways
that fall below are specified <code>minCellCount</code>. These types are
<strong>1</strong>) <code>"cellCount"</code>, <strong>2</strong>)
<code>"remove"</code>, and <strong>3</strong>) <code>"mean"</code>.</p>
<p>We could say we want to censor all pathways that fall below the
<code>minCellCount</code> to be censored <em>to</em> the
<code>minCellCount</code>.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">minEra60</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"minEra60_cellCount"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"minCellCount"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 983 pathways with a frequency &lt;5 to 5.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_cellCount/countsSex.csv</span></span></code></pre>
<p>Or we could completely remove them</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">minEra60</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"minEra60_remove"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"remove"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Removing 983 pathways with a frequency &lt;5.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_remove/countsSex.csv</span></span></code></pre>
<p>Or finally we can censor them as the mean of all the groups that fall
below the <code>minCellCount</code>.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">minEra60</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"minEra60_mean"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 983 pathways with a frequency &lt;5 to mean.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/minEra60_mean/countsSex.csv</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="agewindow">ageWindow<a class="anchor" aria-label="anchor" href="#agewindow"></a>
</h3>
<p>We can also specify an age window.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">splitAcuteTherapy</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"splitAcuteTherapy_ageWindow3"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ageWindow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 2044 pathways with a frequency &lt;5 to mean.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindow3/countsSex.csv</span></span></code></pre>
<p>Or a collection of ages.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">splitAcuteTherapy</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"splitAcuteTherapy_ageWindowMultiple"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ageWindow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 1275 pathways with a frequency &lt;5 to mean.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/splitAcuteTherapy_ageWindowMultiple/countsSex.csv</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="archivename">archiveName<a class="anchor" aria-label="anchor" href="#archivename"></a>
</h3>
<p>Finally we can also specify an <code>archiveName</code> which is the
name of a zip-file to zip all our output csv-files to.</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span></span>
<span>  andromeda <span class="op">=</span> <span class="va">includeEndDate</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"includeEndDate"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  censorType <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ageWindow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  archiveName <span class="op">=</span> <span class="st">"output.zip"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 1812 pathways with a frequency &lt;5 to mean.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/countsSex.csv</span></span></code></pre>
<pre><code><span><span class="co">## Zipping files to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/includeEndDate/output.zip</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="all-in-one">All-in-one<a class="anchor" aria-label="anchor" href="#all-in-one"></a>
</h2>
<p>Instead of using <code>computePathways</code> and
<code>export</code>, instead we could use
<code>executeTreatmentPatterns</code>. Which is an all-in-one function
that trades full control for convenience.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"all-in-one"</span><span class="op">)</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  minEraDuration <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  eraCollapseSize <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  combinationWindow <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span></code></pre>
<pre><code><span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/attrition.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/metadata.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/treatmentPathways.csv</span></span></code></pre>
<pre><code><span><span class="co">## Censoring 1540 pathways with a frequency &lt;5 to mean.</span></span></code></pre>
<pre><code><span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/summaryEventDuration.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/countsYear.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/countsAge.csv</span></span></code></pre>
<pre><code><span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/countsSex.csv</span></span></code></pre>
<pre><code><span><span class="co">## Zipping files to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpQ9uZv0/all-in-one/TreatmentPatterns-Output.zip</span></span></code></pre>
<p>When using <code>DatabaseConnector</code> we can substitute the
<code>cdm</code> object with <code>connectionDetails</code>,
<code>cdmSchema</code>, <code>resultSchema</code>, and
<code>tempEmulationSchema</code>.</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"all-in-one"</span><span class="op">)</span>,</span>
<span>  connectionDetails <span class="op">=</span> <span class="fu">Eunomia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Eunomia/man/getEunomiaConnectionDetails.html" class="external-link">getEunomiaConnectionDetails</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  resultSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minEraDuration <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  eraCollapseSize <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  combinationWindow <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluating-output">Evaluating output<a class="anchor" aria-label="anchor" href="#evaluating-output"></a>
</h2>
<p>Now that we have exported our output, in various ways, we can
evaluate the output. As you may have noticed the <code>export</code>
function exports 6 csv-files: <strong>1</strong>) treatmentPathways.csv,
<strong>2</strong>) countsAge.csv, <strong>3</strong>) countsSex.csv,
<strong>4</strong>) countsYear.csv, <strong>5</strong>)
summaryStatsTherapyDuraion.csv, and <strong>6</strong>) metadata.csv</p>
<div class="section level3">
<h3 id="treatmentpathways">treatmentPathways<a class="anchor" aria-label="anchor" href="#treatmentpathways"></a>
</h3>
<p>The treatmentPathways file contains all the pathways found, with a
frequency, pairwise stratified by age group, sex and index year.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatmentPathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"treatmentPathways.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">treatmentPathways</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   path freq  age    sex indexYear</span></span>
<span><span class="co">## 1 None   12 0-10 female      1950</span></span>
<span><span class="co">## 2 None   12 0-10 female      1951</span></span>
<span><span class="co">## 3 None   17 0-10 female      1952</span></span>
<span><span class="co">## 4 None   19 0-10 female      1953</span></span>
<span><span class="co">## 5 None   11 0-10 female      1954</span></span>
<span><span class="co">## 6 None   18 0-10 female      1955</span></span></code></pre>
<p>We are able to filter based on the strata, and filter on a frequency
&gt; 5.</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">&lt;-</span> <span class="va">treatmentPathways</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">age</span> <span class="op">==</span> <span class="st">"all"</span>,</span>
<span>    <span class="va">sex</span> <span class="op">==</span> <span class="st">"all"</span>,</span>
<span>    <span class="va">indexYear</span> <span class="op">==</span> <span class="st">"all"</span>,</span>
<span>    <span class="va">freq</span> <span class="op">&gt;</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can see the pathways contain the treatment names we provided in
our event cohorts. Besides that we also see the paths are annoted with a
<code>+</code> or <code>-</code>. The <code>+</code> indicates two
treatments are a combination therapy,
i.e. <code>Acetaminophen+Amoxicillin</code> is a combination of
<em>Acetaminophen</em> and <em>Amoxicillin</em>. The <code>-</code>
indicates a switch between treatments,
i.e. <code>Aspirin-Acetaminophen</code> is a switch from
<em>Aspirin</em> to <em>Acetaminophen</em>. Note that these combinations
and switches can occur in the same pathway,
i.e. <code>Amoxicillin+Clavulanate-Aspirin</code>. The first treatment
is a combination of <em>Amoxicillin</em> and <em>Clavulanate</em> that
switches to <em>Aspirin</em>.</p>
</div>
<div class="section level3">
<h3 id="countsage-countssex-and-countsyear">countsAge, countsSex, and countsYear<a class="anchor" aria-label="anchor" href="#countsage-countssex-and-countsyear"></a>
</h3>
<p>The countsAge, countsSex, and countsYear contain counts per age, sex,
and index year.</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"countsAge.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"countsSex.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"countsYear.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   age   n</span></span>
<span><span class="co">## 1   1 311</span></span>
<span><span class="co">## 2   2 550</span></span>
<span><span class="co">## 3   3 340</span></span>
<span><span class="co">## 4   4 181</span></span>
<span><span class="co">## 5   5 158</span></span>
<span><span class="co">## 6   6 107</span></span></code></pre>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      sex    n</span></span>
<span><span class="co">## 1 FEMALE 1092</span></span>
<span><span class="co">## 2   MALE 1067</span></span></code></pre>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   indexYear  n</span></span>
<span><span class="co">## 1      1950 43</span></span>
<span><span class="co">## 2      1951 40</span></span>
<span><span class="co">## 3      1952 54</span></span>
<span><span class="co">## 4      1953 47</span></span>
<span><span class="co">## 5      1954 47</span></span>
<span><span class="co">## 6      1955 49</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="summarystatstherapyduration">summaryStatsTherapyDuration<a class="anchor" aria-label="anchor" href="#summarystatstherapyduration"></a>
</h3>
<p>The summaryEventDuration file contains summary statistics from
different events, across all found “lines”. A “line” is equal to the
level in the Sunburst or Sankey diagrams. The summary statistics allow
for plotting of boxplots with the <code><a href="../reference/plotEventDuration.html">plotEventDuration()</a></code>
function.</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eventDuration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"summaryEventDuration.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ComputingTreatmentPathways_files/figure-html/summaryStatsTherapyDuration-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="metadata">metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>The metadata file is a file that contains information about the
circumstances the analysis was performed in, and information about R,
and the CDM.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"default"</span>, <span class="st">"metadata.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       cdmSourceName cdmSourceAbbreviation cdmReleaseDate</span></span>
<span><span class="co">## 1 Synthea synthetic health database               Synthea     2019-05-25</span></span>
<span><span class="co">##   vocabularyVersion executionStartDate packageVersion</span></span>
<span><span class="co">## 1    v5.0 18-JAN-19         2024-11-26         2.6.10</span></span>
<span><span class="co">##                            rVersion           platform execution_end_date</span></span>
<span><span class="co">## 1 R version 4.3.3 (2024-02-29 ucrt) x86_64-w64-mingw32         2024-11-26</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="sunburst-plot-sankey-diagram">Sunburst Plot &amp; Sankey Diagram<a class="anchor" aria-label="anchor" href="#sunburst-plot-sankey-diagram"></a>
</h3>
<p>From the filtered treatmentPathways file we are able to create a
sunburst plot.</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/createSunburstPlot.html">createSunburstPlot</a></span><span class="op">(</span>treatmentPathways <span class="op">=</span> <span class="va">all</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sunburst html-widget html-fill-item" id="htmlwidget-c3eb87658fa4a2655084" style="width:700px;height:432.632880098888px; position:relative;">
<div>
<div class="sunburst-main">
<div class="sunburst-sequence"></div>
<div class="sunburst-chart">
<div class="sunburst-explanation" style="visibility:hidden;"></div>
</div>
</div>
<div class="sunburst-sidebar">
<input type="checkbox" class="sunburst-togglelegend" style="visibility:hidden;">Legend
<div class="sunburst-legend" style="visibility:hidden;"></div>
</div>
</div>
</div>
<script type="application/json" data-for="htmlwidget-c3eb87658fa4a2655084">{"x":{"data":{"children":[{"name":"None","children":[],"size":1647,"colname":"X1"},{"name":"acetaminophen","children":[{"name":"amoxicillin+clavulanate","size":6,"colname":"X2"},{"name":"aspirin","size":14,"colname":"X2"}],"size":206,"colname":"X1"},{"name":"amoxicillin+clavulanate","children":[],"size":48,"colname":"X1"},{"name":"aspirin","children":[{"name":"acetaminophen","size":12,"colname":"X2"},{"name":"amoxicillin+clavulanate","size":6,"colname":"X2"}],"size":211,"colname":"X1"}],"name":"root"},"options":{"legendOrder":null,"colors":null,"valueField":"size","percent":true,"count":false,"explanation":null,"breadcrumb":[],"legend":{"w":300},"sortFunction":"function (a, b) {return a.value - b.value;}","sumNodes":true}},"evals":["options.sortFunction"],"jsHooks":[]}</script><p>Or a Sankey Diagram.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/createSankeyDiagram.html">createSankeyDiagram</a></span><span class="op">(</span><span class="va">all</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-28d1613b14873593fb86" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-28d1613b14873593fb86">{"x":{"links":{"source":[0,1,1,1,2,3,3,3],"target":[4,4,5,6,4,4,5,7],"value":[76.59999999999999,9.58,0.28,0.65,2.23,9.81,0.28,0.5600000000000001]},"nodes":{"name":["1.None","1.acetaminophen","1.amoxicillin+clavulanate","1.aspirin","2.Stopped","2.amoxicillin+clavulanate","2.aspirin","2.acetaminophen"],"group":["1.None","1.acetaminophen","1.amoxicillin+clavulanate","1.aspirin","2.Stopped","2.amoxicillin+clavulanate","2.aspirin","2.acetaminophen"]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20)","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"%","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Both plots are interactive in an HTML-environment, and are easy to
include in shiny applications.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aniek Markus, Maarten van Kessel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
