<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Latest Changes • TreatmentPatterns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Latest Changes">
<meta property="og:description" content="TreatmentPatterns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreatmentPatterns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bestPractices.html">Best practices</a>
    </li>
    <li>
      <a href="../articles/ComputingTreatmentPathways.html">Computing Treatment Pathways</a>
    </li>
    <li>
      <a href="../articles/LatestChanges.html">Latest Changes</a>
    </li>
    <li>
      <a href="../articles/PareReport.html">PaRe Report: TreatmentPatterns [2.7.0]</a>
    </li>
    <li>
      <a href="../articles/usingTreatmentPatternsShinyModules.html">Using TreatmentPatterns' Shiny Modules</a>
    </li>
    <li>
      <a href="../articles/DefiningCohorts.html">Defining Cohorts</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/darwin-eu/TreatmentPatterns/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Latest Changes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/TreatmentPatterns/blob/HEAD/vignettes/articles/LatestChanges.Rmd" class="external-link"><code>vignettes/articles/LatestChanges.Rmd</code></a></small>
      <div class="hidden name"><code>LatestChanges.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="subject-id-conversion">Subject ID conversion<a class="anchor" aria-label="anchor" href="#subject-id-conversion"></a>
</h2>
<p>As of TreatmentPatterns <code>2.7.0</code> TreatmentPatterns will
assign it’s own pseudo subject ID’s. This is due to subject ID’s in the
database may be 64 bit integers, or may contain letters. This can lead
to strange edge cases where ID’s get rounded, and results of different
individuals will be grouped together.</p>
<p>The real ID’s that exist in the database will be stored as a
<code>character(1)</code> in the <code>cohortTable</code> table, in the
patient level result object from <code><a href="../reference/computePathways.html">computePathways()</a></code></p>
<p>In the following snipit of code we will show how to relate the
internal ID’s to the ID’s existing in the database:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span><span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span> name <span class="op">=</span> <span class="st">"cohort_table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[268ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[177ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[166ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[181ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[104ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[158ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[161ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[245ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert subject_id to subject_id + 1e16 as 64 bit integer</span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">person_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span> cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span> cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputEnv</span><span class="op">$</span><span class="va">treatmentHistory</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">outputEnv</span><span class="op">$</span><span class="va">cohortTable</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">personId</span> <span class="op">==</span> <span class="va">personId</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"personId"</span>, <span class="st">"subject_id_origin"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   SQL [6 x 2]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ\file79f820ad2da0.sqlite]</span></span></span>
<span><span class="co">##   personId subject_id_origin</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      324 10000000000000836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      324 10000000000000836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      324 10000000000000836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>      324 10000000000000836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>      426 10000000000005148</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>      426 10000000000005148</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Andromeda</span><span class="fu">::</span><span class="fu">close</span><span class="op">(</span><span class="va">outputEnv</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span>, shutdown <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="periodpriortoindex-to-indexdateoffset">
<code>periodPriorToIndex</code> to <code>indexDateOffset</code><a class="anchor" aria-label="anchor" href="#periodpriortoindex-to-indexdateoffset"></a>
</h2>
<p>The <code>periodPriorToIndex</code> parameter has been renamed to
<code>indexDateOffset</code>. It was already possible to use the
parameter as an offset, with negative numbers. But this change
solidifies this use-case.</p>
<p>Note that the logic is not inversed. If you want to look back for 30
days prior to the index date previously you would set
<code>periodPriorToIndex = 30</code> which now equals
<code>indexDateOffset = -30</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span><span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span> name <span class="op">=</span> <span class="st">"cohort_table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[169ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[158ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[164ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[141ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[98ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[143ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[157ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[243ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert subject_id to subject_id + 1e16 as 64 bit integer</span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">person_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span> cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span> cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> <span class="co"># Look back (index date - 30 days)</span></span>
<span> indexDateOffset <span class="op">=</span> <span class="op">-</span><span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (-30)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span> cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span> cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> <span class="co"># Look ahead (index date + 30 days)</span></span>
<span> indexDateOffset <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (30)</span></span>
<span><span class="co">##  Records: 6349</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 6267</span></span>
<span><span class="co">##  Subjects: 2077</span></span>
<span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 6267</span></span>
<span><span class="co">##  Subjects: 2077</span></span>
<span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 362</span></span>
<span><span class="co">##  Subjects: 341</span></span>
<span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 359</span></span>
<span><span class="co">##  Subjects: 341</span></span>
<span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 359</span></span>
<span><span class="co">##  Subjects: 341</span></span>
<span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 358</span></span>
<span><span class="co">##  Subjects: 341</span></span>
<span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 358</span></span>
<span><span class="co">##  Subjects: 341</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="empty-data">Empty data<a class="anchor" aria-label="anchor" href="#empty-data"></a>
</h2>
<p>In previous versions TreatmentPatterns, TreatmentPatterns would throw
an ambiguous error from <code>dplyr</code> if the <code>target</code>
was empty, wasn’t assigned or other related issues.</p>
<p>Now TreatmentPatterns throws more informative errors and warnings
when something like this is detected.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span><span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"cohort_table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[152ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[158ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[136ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[143ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[100ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[151ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[142ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[226ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert subject_id to subject_id + 1e16 as 64 bit integer</span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">person_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  <span class="co"># Set minEraDuration, minPostCombinationWindow, and combinationWindow to</span></span>
<span>  <span class="co"># unreasonably large values, so no record qualifies.</span></span>
<span>  minEraDuration <span class="op">=</span> <span class="fl">9999999</span>,</span>
<span>  minPostCombinationDuration <span class="op">=</span> <span class="fl">9999999</span>,</span>
<span>  combinationWindow <span class="op">=</span> <span class="fl">9999999</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (9999999)</span></span>
<span><span class="co">##  Records: 0</span></span>
<span><span class="co">##  Subjects: 0</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 0</span></span>
<span><span class="co">##  Subjects: 0</span></span></code></pre>
<pre><code><span><span class="co">## Warning in constructPathways(settings = args, andromeda = andromeda): No cases</span></span>
<span><span class="co">## found. Generating empty treatmentHistory table.</span></span></code></pre>
<pre><code><span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 0</span></span>
<span><span class="co">##  Subjects: 0</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Only set "event" types</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span>  cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in validateComputePathways(): No 'target' cohort specified in `cohorts`.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summarystatstherapyduration-csv-to-summaryeventduration-csv">
<code>summaryStatsTherapyDuration.csv</code> to
<code>summaryEventDuration.csv</code><a class="anchor" aria-label="anchor" href="#summarystatstherapyduration-csv-to-summaryeventduration-csv"></a>
</h2>
<p>The <code>summaryStatsTherapyDuration.csv</code> has been renamed to
<code>summaryEventDuration.csv</code>. The file now fully focuses on the
duration of events, across different levels in the pathways, and
overall.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span><span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span> name <span class="op">=</span> <span class="st">"cohort_table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[150ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[146ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[150ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[147ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[105ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[147ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[157ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[218ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert subject_id to subject_id + 1e16 as 64 bit integer</span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">person_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span> cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span> cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tempDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span><span class="va">outputEnv</span>, outputPath <span class="op">=</span> <span class="va">tempDir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/attrition.csv</span></span>
<span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/metadata.csv</span></span>
<span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/treatmentPathways.csv</span></span>
<span><span class="co">## Censoring 1219 pathways with a frequency &lt;5 to 5.</span></span>
<span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/summaryEventDuration.csv</span></span>
<span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsYear.csv</span></span>
<span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsAge.csv</span></span>
<span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsSex.csv</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eventDuration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"summaryEventDuration.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eventDuration</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           eventName min    Q1 median     Q2 max  average       sd count    line</span></span>
<span><span class="co">## 1 combination-event  35 56.00   84.0 112.00 329 90.23438 48.59575  1711 overall</span></span>
<span><span class="co">## 2        mono-event  30 34.00   44.0  67.00 119 53.97751 23.84533   489 overall</span></span>
<span><span class="co">## 3 combination-event  35 54.25   87.5 113.75 329 91.94231 50.85790  1699       1</span></span>
<span><span class="co">## 4 combination-event  35 66.50   77.0  92.75 182 82.83333 38.20479    12       2</span></span>
<span><span class="co">## 5        mono-event  30 34.00   44.0  67.00 119 53.90217 23.88975   460       1</span></span>
<span><span class="co">## 6        mono-event  30 35.00   60.0  67.00  90 55.17241 23.50694    29       2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="event-duration-with-ploteventduration">Event duration with <code>plotEventDuration()</code><a class="anchor" aria-label="anchor" href="#event-duration-with-ploteventduration"></a>
</h2>
<p>The Sunburst plot and Sankey diagram are limited in that they do not
show anything about duration of events. The
<code><a href="../reference/plotEventDuration.html">plotEventDuration()</a></code> function is an attempt to also provide
something meaningful about the duration of events:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latestChanges_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latestChanges_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latestChanges_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"individual"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latestChanges_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEventDuration.html">plotEventDuration</a></span><span class="op">(</span></span>
<span>  eventDurations <span class="op">=</span> <span class="va">eventDuration</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  treatmentGroups <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  eventLines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeOverall <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latestChanges_files/figure-html/unnamed-chunk-5-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="attrition">Attrition<a class="anchor" aria-label="anchor" href="#attrition"></a>
</h2>
<p>Status messages have been updated when running
<code><a href="../reference/computePathways.html">computePathways()</a></code>. All messages are now also recorded in an
attrition table. Which keeps track of the number of records and subjects
left in the analysis.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darwin-eu/TreatmentPatterns" class="external-link">TreatmentPatterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span><span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">cohortSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/read_cohort_set.html" class="external-link">readCohortSet</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span>, <span class="st">"exampleCohorts"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/generateCohortSet.html" class="external-link">generateCohortSet</a></span><span class="op">(</span></span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span> cohortSet <span class="op">=</span> <span class="va">cohortSet</span>,</span>
<span> name <span class="op">=</span> <span class="st">"cohort_table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating 8 cohorts</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (1/8) - acetaminophen<span style="color: #00BB00;">✔</span> Generating cohort (1/8) - acetaminophen <span style="color: #B2B2B2;">[155ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (2/8) - amoxicillin<span style="color: #00BB00;">✔</span> Generating cohort (2/8) - amoxicillin <span style="color: #B2B2B2;">[155ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (3/8) - aspirin<span style="color: #00BB00;">✔</span> Generating cohort (3/8) - aspirin <span style="color: #B2B2B2;">[148ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (4/8) - clavulanate<span style="color: #00BB00;">✔</span> Generating cohort (4/8) - clavulanate <span style="color: #B2B2B2;">[146ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (5/8) - death<span style="color: #00BB00;">✔</span> Generating cohort (5/8) - death <span style="color: #B2B2B2;">[105ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (6/8) - doxylamine<span style="color: #00BB00;">✔</span> Generating cohort (6/8) - doxylamine <span style="color: #B2B2B2;">[150ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (7/8) - penicillinv<span style="color: #00BB00;">✔</span> Generating cohort (7/8) - penicillinv <span style="color: #B2B2B2;">[154ms]</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Generating cohort (8/8) - viralsinusitis<span style="color: #00BB00;">✔</span> Generating cohort (8/8) - viralsinusitis <span style="color: #B2B2B2;">[233ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 5 casted column in <span style="font-weight: bold;">cohort_table (cohort_attrition)</span> as do not match expected</span></span>
<span><span class="co">##   column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `number_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `reason_id` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_records` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `excluded_subjects` from <span style="color: #0000BB;">numeric</span> to <span style="color: #0000BB;">integer</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: <span style="color: #BBBB00;">!</span> 1 column in <span style="font-weight: bold;">cohort_table</span> do not match expected column type:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `subject_id` is <span style="color: #0000BB;">numeric</span> but expected <span style="color: #0000BB;">integer</span></span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert subject_id to subject_id + 1e16 as 64 bit integer</span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">cohort_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">person</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu">bit64</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bit64/man/as.integer64.character.html" class="external-link">as.integer64</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">person_id</span> <span class="op">+</span> <span class="fl">1e16</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">compute</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="va">cohortSet</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="co"># Remove 'cohort' and 'json' columns</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"cohort"</span>, <span class="op">-</span><span class="st">"json"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"exit"</span>, <span class="st">"event"</span>, <span class="st">"event"</span>, <span class="st">"target"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   cohortId <span class="op">=</span> <span class="st">"cohort_definition_id"</span>,</span>
<span>   cohortName <span class="op">=</span> <span class="st">"cohort_name"</span>,</span>
<span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"cohortId"</span>, <span class="st">"cohortName"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputEnv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePathways.html">computePathways</a></span><span class="op">(</span></span>
<span> cohorts <span class="op">=</span> <span class="va">cohorts</span>,</span>
<span> cohortTableName <span class="op">=</span> <span class="st">"cohort_table"</span>,</span>
<span> cdm <span class="op">=</span> <span class="va">cdm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -- Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">##  Records: 14041</span></span>
<span><span class="co">##  Subjects: 2693</span></span>
<span><span class="co">## -- Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">##  Records: 11386</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">##  Records: 8381</span></span>
<span><span class="co">##  Subjects: 2159</span></span>
<span><span class="co">## -- splitEventCohorts</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- eraCollapse (30)</span></span>
<span><span class="co">##  Records: 8366</span></span>
<span><span class="co">##  Subjects: 2144</span></span>
<span><span class="co">## -- Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 558</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- After Combination</span></span>
<span><span class="co">##  Records: 554</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- filterTreatments (First)</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span>
<span><span class="co">## -- treatment construction done</span></span>
<span><span class="co">##  Records: 553</span></span>
<span><span class="co">##  Subjects: 512</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tempDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/export.html">export</a></span><span class="op">(</span><span class="va">outputEnv</span>, outputPath <span class="op">=</span> <span class="va">tempDir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Writing attrition to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/attrition.csv</span></span>
<span><span class="co">## Writing metadata to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/metadata.csv</span></span>
<span><span class="co">## Writing treatmentPathways to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/treatmentPathways.csv</span></span>
<span><span class="co">## Censoring 1219 pathways with a frequency &lt;5 to 5.</span></span>
<span><span class="co">## Writing summaryStatsTherapyDuration to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/summaryEventDuration.csv</span></span>
<span><span class="co">## Writing countsYearPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsYear.csv</span></span>
<span><span class="co">## Writing countsAgePath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsAge.csv</span></span>
<span><span class="co">## Writing countsSexPath to C:\Users\MVANKE~1\AppData\Local\Temp\RtmpUjLffZ/tp/countsSex.csv</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">attrition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"attrition.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">attrition</span></span></code></pre></div>
<pre><code><span><span class="co">##    number_records number_subject reason_id</span></span>
<span><span class="co">## 1           14041           2693         1</span></span>
<span><span class="co">## 2           11386           2159         2</span></span>
<span><span class="co">## 3            8381           2159         3</span></span>
<span><span class="co">## 4            8366           2144         4</span></span>
<span><span class="co">## 5            8366           2144         5</span></span>
<span><span class="co">## 6             558            512         6</span></span>
<span><span class="co">## 7             554            512         6</span></span>
<span><span class="co">## 8             554            512         7</span></span>
<span><span class="co">## 9             553            512         8</span></span>
<span><span class="co">## 10            553            512         9</span></span>
<span><span class="co">##                                                                        reason</span></span>
<span><span class="co">## 1           Qualifying records for cohort definitions: 1, 2, 3, 4, 5, 6, 7, 8</span></span>
<span><span class="co">## 2                                       Removing records &lt; minEraDuration (0)</span></span>
<span><span class="co">## 3  Removing events where index date &lt; target index date + indexDateOffset (0)</span></span>
<span><span class="co">## 4                                                           splitEventCohorts</span></span>
<span><span class="co">## 5                                                            eraCollapse (30)</span></span>
<span><span class="co">## 6        Iteration 1: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">## 7        Iteration 2: minPostCombinationDuration (30), combinatinoWindow (30)</span></span>
<span><span class="co">## 8                                                           After Combination</span></span>
<span><span class="co">## 9                                                    filterTreatments (First)</span></span>
<span><span class="co">## 10                                                treatment construction done</span></span>
<span><span class="co">##          time</span></span>
<span><span class="co">## 1  1732631613</span></span>
<span><span class="co">## 2  1732631613</span></span>
<span><span class="co">## 3  1732631614</span></span>
<span><span class="co">## 4  1732631614</span></span>
<span><span class="co">## 5  1732631614</span></span>
<span><span class="co">## 6  1732631616</span></span>
<span><span class="co">## 7  1732631618</span></span>
<span><span class="co">## 8  1732631619</span></span>
<span><span class="co">## 9  1732631619</span></span>
<span><span class="co">## 10 1732631620</span></span></code></pre>
<p>The attrition table has the following columns: - number_records:
Number of records left in the analysis, at any given stage. -
number_subjects: Number of subjects in the analysis, at any given stage.
- reason_id: Identification field per stage of the analysis. - reason:
Description of why records were removed. - time: Time stamp as in number
of seconds since 1970-01-01 (time since epoch).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aniek Markus, Maarten van Kessel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
